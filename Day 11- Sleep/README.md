<div class="px-5 pt-4"><div class="_1l1MA" data-track-load="qd_description_content"><p>Given&nbsp;a positive integer <code>millis</code>, write an asyncronous function that sleeps for <code>millis</code>&nbsp;milliseconds. It can resolve&nbsp;any value.</p>

<p>&nbsp;</p>
<p><strong class="example">Example 1:</strong></p>

<pre><strong>Input:</strong> millis = 100
<strong>Output:</strong> 100
<strong>Explanation:</strong> It should return a promise that resolves after 100ms.
let t = Date.now();
sleep(100).then(() =&gt; {
  console.log(Date.now() - t); // 100
});
</pre>

<p><strong class="example">Example 2:</strong></p>

<pre><strong>Input:</strong> millis = 200
<strong>Output:</strong> 200
<strong>Explanation:</strong> It should return a promise that resolves after 200ms.
</pre>

<p>&nbsp;</p>
<p><strong>Constraints:</strong></p>

<ul>
	<li><code>1 &lt;= millis &lt;= 1000</code></li>
</ul>
</div></div>


<div class="break-words"><div><div class="_16yfq _2YoR3"><h2 id="solution">Solution</h2>
<hr>
<h3 id="overview">Overview</h3>
<p>The problem involves the concept of <a href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Introducing" target="_blank">asynchronous programming</a>. Specifically, it focuses on promises and the <code>setTimeout</code> function, a web API method that introduces a delay in the execution of code.</p>
<p>A promise in JavaScript is an object representing the eventual completion or failure of an asynchronous operation. Essentially, it's a returned object to which you attach callbacks, as opposed to passing callbacks into a function.</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> promise </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">new</span><span> </span><span class="token" style="color: rgb(78, 201, 176);">Promise</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">resolve</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span class="token" style="color: rgb(156, 220, 254);"> reject</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> condition </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">true</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>  </span><span class="token" style="color: rgb(106, 153, 85);">// This could be the result of some operation</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color: rgb(106, 153, 85);">// After 1 second, check the condition and resolve or reject the promise</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(220, 220, 170);">setTimeout</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(197, 134, 192);">if</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>condition</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>            </span><span class="token" style="color: rgb(220, 220, 170);">resolve</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Promise fulfilled!'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">else</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>            </span><span class="token" style="color: rgb(220, 220, 170);">reject</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Promise rejected!'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> </span><span class="token" style="color: rgb(181, 206, 168);">1000</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(106, 153, 85);">// Attach then() and catch() handlers to the Promise</span><span>
</span></span><span>promise
</span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">value</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// This will be executed if the promise is resolved</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>value</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span> </span><span class="token" style="color: rgb(106, 153, 85);">// Output: Promise fulfilled!</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">error</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// This will be executed if the promise is rejected</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>In this example, a promise is created and will either resolve or reject after 1 second, depending on the value of condition. The <code>resolve</code> function is called if the promise is successful, and reject is called if the promise fails.</p>
<p>The <code>then</code> method is called when the promise is resolved and receives the value passed to the resolve function. Similarly, the catch method is called when the promise is rejected and receives the value passed to the reject function.</p>
<h4 id="settimeout-and-event-loop">setTimeout and Event Loop</h4>
<p>The <code>setTimeout</code> function plays a key role in this problem. It's a method that calls a function or evaluates an expression after a specified number of milliseconds. In JavaScript, setTimeout is used to delay the execution of a piece of code.</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Starting the timer..."</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">setTimeout</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Timeout completed!"</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> </span><span class="token" style="color: rgb(181, 206, 168);">2000</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>In this example, "Starting the timer..." will be logged to the console immediately. Then, the setTimeout function is called with two arguments: a callback function and a delay in milliseconds. The callback function is a simple arrow function that logs "Timeout completed!" to the console, and the delay is 2000 milliseconds (or 2 seconds).</p>
<p>Once <code>setTimeout</code> is called, the JavaScript runtime sets up the timer, but then immediately continues executing any following code. It does not pause or wait for the timer to finish, illustrating the non-blocking nature of JavaScript.</p>
<p>After the specified delay (2 seconds in this case), the callback function is added to the task queue. However, it's important to note that the callback function is not necessarily executed right at this moment. The actual delay until the callback function is invoked may be slightly longer than the specified delay. This is due to the nature of the event-driven JavaScript runtime and the single-threaded event loop.</p>
<p>Imagine if there was a long process or operation blocking the main JavaScript thread. In such a scenario, even if the timer has completed in the background, the callback function would still have to wait for the completion of the blocking task. This is because the event loop can only handle one task at a time, and it processes tasks in the order they are queued.</p>
<p>Therefore, the '2 seconds' specified in <code>setTimeout</code> should be understood as the 'minimum delay' before the callback function is invoked, rather than a 'guaranteed delay'. If the JavaScript runtime is busy with other tasks, it could take longer than 2 seconds for the callback function to actually get executed. This behavior underscores the importance of understanding the asynchronous nature of JavaScript, as it can have significant implications for the performance and behavior of your code.</p>
<p>It's also worth to mention <code>clearTimeout</code> which is a valuable function in JavaScript's suite of timer functions. <code>clearTimeout</code> is a function that cancels a timeout previously established by calling <code>setTimeout</code>.</p>
<p>Here's how you use it:</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Starting the timer..."</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(106, 153, 85);">// setTimeout returns a Timeout object which can be used to reference the timer</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> timeoutId </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">setTimeout</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Timeout completed!"</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> </span><span class="token" style="color: rgb(181, 206, 168);">2000</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(106, 153, 85);">// Some condition or logic</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(197, 134, 192);">if</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(106, 153, 85);">/* some condition */</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(106, 153, 85);">// Cancels the timeout</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(220, 220, 170);">clearTimeout</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>timeoutId</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>If the condition inside the if statement is true, then the clearTimeout function will cancel the timeout that was set by setTimeout. If the timeout is cancelled, the function provided to setTimeout will not be invoked.</p>
<p>This can be useful in various scenarios where you might want to cancel a delayed operation if a certain condition is met before the operation executes. For instance, if you have a function that runs after a delay to check if a user is still active on a page, but the user navigates away before the delay is up, you could use clearTimeout to cancel the check.</p>
<h5 id="javascripts-event-loop">JavaScript's Event Loop</h5>
<p>JavaScript uses a call stack to manage the execution of functions. When a function is called, it's added to the stack. When the function completes, it's removed from the stack. JavaScript, being single-threaded, can only execute one function at a time.</p>
<p>However, this could be problematic if a function takes a long time to execute (like a network request). This is where the Event Loop comes in.</p>
<p>The Event Loop is a continuous loop that checks if the call stack is empty. If it is, it takes the first task from the task queue (also known as the event queue or the callback queue) and pushes it onto the call stack, which immediately executes it.</p>
<h5 id="asynchronous-callbacks">Asynchronous Callbacks</h5>
<p><code>setTimeout</code> is an example of an asynchronous function in JavaScript. When the <code>setTimeout</code> function is called, it starts a timer and then immediately returns, allowing the JavaScript runtime to continue executing other code without waiting for the timer to complete. This is the non-blocking nature of JavaScript.</p>
<p>Once the timer completes, the callback function given to <code>setTimeout</code> is added to the task queue. The Event Loop constantly checks the call stack and the task queue. When the call stack is empty, it takes the first task from the task queue and pushes it onto the call stack to be executed.</p>
<h5 id="concurrency-and-the-event-loop">Concurrency and the Event Loop</h5>
<p>Here's how JavaScript can handle concurrent operations:</p>
<ol>
<li>JavaScript runs a piece of code (this code is running on the main thread).</li>
<li>When an async operation is encountered (like setTimeout, fetch, etc.), JavaScript sets it up and then continues running the rest of the code. It doesn't wait for the async operation to complete. This async operation might be running in the background but not on the main JavaScript thread.</li>
<li>When the async operation completes, its callback function is placed into the task queue.</li>
<li>Once the call stack is empty (i.e., all the code in the current turn of the Event Loop has been executed), the Event Loop takes the first task from the task queue and pushes it onto the call stack, which immediately executes it.</li>
<li>This process continues, with the Event Loop pushing tasks from the task queue onto the call stack whenever the call stack is empty, allowing JavaScript to handle multiple operations concurrently despite being single-threaded.</li>
</ol>
<p>This is a high-level overview of how JavaScript handles asynchronous operations. It's more complex in reality, with additional features like microtasks and macrotasks, but this is the fundamental concept.</p>
<p>This problem requires the creation of a function that simulates a delay, often referred to as a "sleep" function in programming. This function leverages both promises and <code>setTimeout</code> to create an asynchronous delay, returning a promise that resolves after a specified amount of time.</p>
<p>These concepts form an integral part of JavaScript programming, especially in scenarios where certain operations need to be paused or delayed without halting the rest of the code execution. Understanding how to use setTimeout and promises together is a valuable skill in many real-world applications, such as rate-limiting API requests or managing user interactions.</p>
<p>To simplify working with promises, JavaScript provides the <code>async</code> and <code>await</code> keywords, which allow you to write asynchronous code that looks and behaves more like synchronous code. The <code>async</code> keyword is used to declare an asynchronous function. When called, an async function returns a promise. When the async function returns a value, the promise is fulfilled with that value. If the async function throws an exception, the promise is rejected with the thrown value.
Here's a simple example of an async function:</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(86, 156, 214);">async</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">function</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">foo</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(197, 134, 192);">return</span><span> </span><span class="token" style="color: rgb(206, 145, 120);">'Hello, World!'</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">foo</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">message</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>message</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span> </span><span class="token" style="color: rgb(106, 153, 85);">// logs 'Hello, World!'</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>The <code>foo</code> function is declared with the <code>async</code> keyword, which means it returns a promise. When foo is called, it returns a promise that is immediately fulfilled with the value 'Hello, World!'. The promise returned by an async function can be used with the <code>.then</code> method to schedule code to run after the promise is fulfilled, or with the <code>await</code> keyword to pause the execution of the async function until the promise is fulfilled. Keep in mind that even though async functions make asynchronous code look and behave more like synchronous code, they are still non-blocking. The JavaScript runtime can continue doing other work while waiting for the promise returned by an async function to be fulfilled.</p>
<p>Here's a specific example of how asynchronous programming can be used for handling user interactions. Consider a web page where the user can click a button to load data from a server, perhaps a list of items to display. When the button is clicked, you don't want to freeze the entire page while waiting for the server to respond. Instead, you want to handle the request asynchronously. Here's how you might do this:</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(106, 153, 85);">// The 'async' keyword allows the use of 'await' inside the function</span><span>
</span></span><span><span>button</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">addEventListener</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'click'</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">async</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(106, 153, 85);">// Show a loading spinner</span><span>
</span></span><span><span>    spinner</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token property-access">style</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token property-access">display</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(206, 145, 120);">'block'</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">try</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// Fetch data from server</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> response </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">await</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">fetch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'https://api.example.com/items'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// Parse the JSON response</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> items </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">await</span><span> response</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">json</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// Update the UI with the new items</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(220, 220, 170);">displayItems</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>items</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// Handle any errors</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Error:'</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">finally</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>        </span><span class="token" style="color: rgb(106, 153, 85);">// Hide the loading spinner</span><span>
</span></span><span><span>        spinner</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token property-access">style</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token property-access">display</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(206, 145, 120);">'none'</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>In this example, when the button is clicked, the browser sends a request to the server to fetch the data. The fetch function returns a promise that resolves to the response object representing the response to the request. By using the <code>await</code> keyword, we're able to write code that looks synchronous but actually runs asynchronously. This means the browser can continue to handle other tasks, like user input or animation, while waiting for the server to respond. Once the data is received from the server, it's parsed as JSON (which also returns a promise), and then the UI is updated with the new items. If anything goes wrong during this process, the error will be caught and logged to the console. Finally, regardless of whether the request was successful or not, the loading spinner is hidden. So in this case, the user interaction is the button click, but the fetching of data and updating of the UI are handled asynchronously.</p>
<h4 id="asyncawait">Async/await</h4>
<p>Async/await can be seen as syntax sugar on top of promises, making asynchronous code easier to write and understand. When we mark a function with the <code>async</code> keyword, it becomes an asynchronous function that automatically returns a promise. Within an async function, we can use the <code>await</code> keyword to pause the execution of the code until the promise is resolved or rejected.</p>
<p>By employing await, we can eliminate the need for explicit .then() and .catch() chains that are typically used with promises. Instead, we can structure our code in a more linear and synchronous-looking manner. This makes it easier to reason about the flow of the program and handle errors in a more concise way.</p>
<p>Example:</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(106, 153, 85);">// Using explicit .then() and .catch() with promises</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">fetchData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">response</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(106, 153, 85);">// Handle the response</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Response:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">return</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">processData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">result</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(106, 153, 85);">// Handle the processed data</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Processed data:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> result</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">error</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(106, 153, 85);">// Handle any errors</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Error:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(106, 153, 85);">// Using async/await</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(86, 156, 214);">async</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">function</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">fetchDataAndProcess</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(197, 134, 192);">try</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(86, 156, 214);">const</span><span> response </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">await</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">fetchData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Response:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span>    </span><span class="token" style="color: rgb(86, 156, 214);">const</span><span> result </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">await</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">processData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Processed data:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> result</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span> </span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Error:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">fetchDataAndProcess</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>Using explicit <code>.then()</code> and <code>.catch()</code> chains, we have to handle each step of the asynchronous operations separately. It can become complex when multiple promises are involved, leading to nested or chained <code>.then()</code> calls. Additionally, error handling requires a separate <code>.catch()</code> block.</p>
<p>In contrast, the second example utilizes async/await to structure the code in a more linear and synchronous-looking manner. The <code>fetchDataAndProcess()</code> function is marked as async, allowing us to use the <code>await</code> keyword inside it. This eliminates the need for explicit <code>.then()</code> and <code>.catch()</code> chains.</p>
<p>Under the hood, the <code>await</code> keyword halts the execution of the function, allowing other tasks to continue, such as handling user input or animations. The JavaScript engine switches to executing other code until the awaited promise is settled, at which point it resumes executing the remaining code within the async function.</p>
<h4 id="promise-chaining">Promise Chaining</h4>
<p>Promise chaining is a technique in JavaScript that allows you to perform multiple asynchronous operations in a sequence, with each operation starting when the previous one has completed. The primary advantage of promise chaining is that it allows you to avoid the "callback hell" or "pyramid of doom" that can result from using nested callbacks to handle asynchronous code. Instead, you can write asynchronous code that almost looks like synchronous code, making it much easier to understand and maintain. Each <code>then</code> in a promise chain receives the result of the previous promise's resolution. This result can be used to inform the next step in the chain. If a promise in the chain is rejected, the chain's subsequent <code>then</code> methods will be skipped until a catch method is found.</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(220, 220, 170);">fetchData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">response</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Response:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">return</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">processData</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>response</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>  </span><span class="token" style="color: rgb(106, 153, 85);">// This returns a new promise</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">processedData</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Processed data:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> processedData</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">return</span><span> </span><span class="token" style="color: rgb(220, 220, 170);">furtherProcessing</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>processedData</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>  </span><span class="token" style="color: rgb(106, 153, 85);">// This returns another new promise</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">finalResult</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Final result:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> finalResult</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">error</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">"Error:"</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p><code>fetchData</code>, <code>processData</code>, and <code>furtherProcessing</code> are all asynchronous functions that return promises. The <code>then</code> methods are chained together, with each one waiting for the previous promise to resolve before starting its operation. If any promise in the chain is rejected, the catch method at the end will be invoked to handle the error.</p>
<h4 id="understanding-finally">Understanding .finally</h4>
<p>In JavaScript, Promises offer several powerful methods for handling asynchronous actions and their results. One of these methods is <code>.finally</code>. The <code>.finally</code> method is a built-in method of a Promise that is always executed, regardless of whether the promise is fulfilled or rejected. This makes it an excellent place to put cleanup code that must be run regardless of the outcome of the promise.</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> isLoading </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">true</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span>
</span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">fetch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'https://api.example.com/data'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">response</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">if</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">!</span><span>response</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token property-access">ok</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>      </span><span class="token" style="color: rgb(197, 134, 192);">throw</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">new</span><span> </span><span class="token" style="color: rgb(78, 201, 176);">Error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Network response was not ok'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(197, 134, 192);">return</span><span> response</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">json</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">data</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span>data</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token" style="color: rgb(197, 134, 192);">catch</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(156, 220, 254);">error</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">error</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Error:'</span><span class="token" style="color: rgb(212, 212, 212);">,</span><span> error</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token" style="color: rgb(197, 134, 192);">finally</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    isLoading </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">false</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(206, 145, 120);">'Fetch operation finished'</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span>  </span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>We're using fetch here (which returns a promise) to retrieve data from a URL. We then use <code>.then</code> to handle the response, and <code>.catch</code> to handle any errors. Finally, regardless of whether the fetch operation was successful or not, <code>.finally</code> is called to set isLoading to false and log a message to the console.</p>
<h4 id="understanding-promise-returns-in-async-functions">Understanding Promise Returns in Async Functions</h4>
<p>One interesting fact that might come in handy when solving this problem is that whether you return a promise with <code>return new Promise()</code> or <code>return await new Promise()</code> inside an async function, the behavior usually remains the same. This is because an async function always wraps the returned value in a promise. However, using <code>await</code> can make a difference in certain situations, such as error handling.</p>
<p>Consider the following example:</p>
<iframe src="https://leetcode.com/playground/B9Jtwdv4/shared" width="100%" height="446" name="user-content-B9Jtwdv4" allowfullscreen="" translate="no"></iframe>
<p>In the <code>example</code> function, the catch block doesn't catch the error from the promise, because the promise is returned before it has a chance to throw the error. In <code>example2</code>, the <code>await</code> causes the function to pause until the promise either resolves or throws an error, so the catch block is able to catch the error.</p>
<p>In the given problem, you're tasked with creating an asynchronous function, <code>sleep(millis)</code>, which is designed to pause execution for a specified number of milliseconds. Let's explore how we can achieve this below.</p>
<hr>
<h3 id="approach-1-asynchronous-programming-with-promises-and-settimeout">Approach 1: Asynchronous Programming with Promises and setTimeout</h3>
<h4 id="intuition">Intuition</h4>
<p>In JavaScript, asynchronous operations are typically handled using promises. A promise represents a value that may not be available yet, but will be resolved at some point in the future (or rejected, in case of an error). To simulate a delay, or "sleep", in JavaScript, we can use the setTimeout function, which schedules a function to be run after a certain amount of time.</p>
<p>The task requires us to create an asynchronous function that sleeps for a specified amount of milliseconds. To achieve this, we can combine promises with <code>setTimeout</code>. We will return a promise that gets resolved after the specified delay.</p>
<h4 id="algorithm">Algorithm</h4>
<ol>
<li>Define an asynchronous function named <code>sleep(millis)</code>. This function is expected to pause execution for <code>millis</code> milliseconds before resolving.</li>
<li>Inside this function, construct a new promise object. The executor function of this promise object is where we'll incorporate our delay.</li>
<li>Within the executor function, use the <code>setTimeout</code> method. <code>setTimeout</code> is a method provided by the host environment (web browsers, Node.js, etc.) that executes a provided function or piece of code after a specified delay.</li>
<li>Set the delay of <code>setTimeout</code> to be <code>millis</code> milliseconds. The code to execute after the delay will be the resolve method of the promise.</li>
<li>The resolve method, when called, will mark the promise as fulfilled, allowing any attached <code>.then</code> handlers to execute.</li>
</ol>
<h4 id="implementation">Implementation</h4>
<iframe src="https://leetcode.com/playground/7namjTQt/shared" width="100%" height="140" name="user-content-7namjTQt" allowfullscreen="" translate="no"></iframe>
<p>In this implementation, the sleep function is an async function that returns a promise. The executor function of the promise uses <code>setTimeout</code> to resolve the promise after <code>millis</code> milliseconds. Note that we don't actually need to make the sleep function async, since we're returning a promise directly, but it doesn't hurt to mark it as <code>async</code>.</p>
<p>You can use the sleep function in your code like this:</p>
<div class="mb-6 rounded-lg px-3 py-2.5 font-menlo text-sm bg-fill-3 dark:bg-dark-fill-3"><div class="group relative" translate="no"><pre style="color: rgb(212, 212, 212); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none; padding: 0px; margin: 0px; overflow: auto; background: transparent;"><code class="language-javascript" style="color: rgb(156, 220, 254); font-size: 13px; text-shadow: none; font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 4; hyphens: none;"><span><span class="token" style="color: rgb(86, 156, 214);">let</span><span> t </span><span class="token" style="color: rgb(212, 212, 212);">=</span><span> </span><span class="token known-class-name" style="color: rgb(78, 201, 176);">Date</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">now</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(220, 220, 170);">sleep</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(181, 206, 168);">100</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">then</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(86, 156, 214);">=&gt;</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">{</span><span>
</span></span><span><span>    </span><span class="token" style="color: rgb(78, 201, 176);">console</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">log</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token known-class-name" style="color: rgb(78, 201, 176);">Date</span><span class="token" style="color: rgb(212, 212, 212);">.</span><span class="token method property-access" style="color: rgb(220, 220, 170);">now</span><span class="token" style="color: rgb(212, 212, 212);">(</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span> </span><span class="token" style="color: rgb(212, 212, 212);">-</span><span> t</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span><span> </span><span class="token" style="color: rgb(106, 153, 85);">// approximately 100</span><span>
</span></span><span><span></span><span class="token" style="color: rgb(212, 212, 212);">}</span><span class="token" style="color: rgb(212, 212, 212);">)</span><span class="token" style="color: rgb(212, 212, 212);">;</span></span></code></pre><div class="h-4 w-4 cursor-pointer absolute top-0 right-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="1em" height="1em" fill="currentColor" class="h-4 w-4 fill-gray-6 hover:fill-gray-7 dark:fill-dark-gray-6 dark:hover:fill-dark-gray-7 hidden group-hover:block"><path fill-rule="evenodd" d="M11.3 8.3H19a3 3 0 013 3V19a3 3 0 01-3 3h-7.7a3 3 0 01-3-3v-7.7a3 3 0 013-3zm0 2a1 1 0 00-1 1V19a1 1 0 001 1H19a1 1 0 001-1v-7.7a1 1 0 00-1-1h-7.7zm-5.6 3.4a1 1 0 110 2h-.9A2.8 2.8 0 012 12.9V4.8A2.8 2.8 0 014.8 2h8.1a2.8 2.8 0 012.8 2.8v.9a1 1 0 11-2 0v-.9a.8.8 0 00-.8-.8H4.8a.8.8 0 00-.8.8v8.1a.8.8 0 00.8.8h.9z" clip-rule="evenodd"></path></svg></div></div></div>
<p>In this usage, we record the current time, call the <code>sleep</code> function, and then log the elapsed time when the promise resolves. The elapsed time should be approximately equal to the input to sleep, indicating that the function has indeed "slept" for the specified amount of time.</p>
<p>Note that both returning the promise with <code>return new Promise()</code> or <code>return await new Promise()</code> will give you the same result in an async function, as described in the overview section.</p>
<p>Also using <code>try {} catch(){}</code> is a common practice in asynchronous programming, as it allows you to handle any potential exceptions that may be thrown. In the solution below, if an error occurs during the execution of the setTimeout function, the promise is rejected with the thrown error:</p>
<iframe src="https://leetcode.com/playground/avz7DdXm/shared" width="100%" height="208" name="user-content-avz7DdXm" allowfullscreen="" translate="no"></iframe>
<h4 id="complexity-analysis">Complexity Analysis</h4>
<p>Time complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>. The time complexity of the function is <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> because the computational effort remains constant regardless of the input. However, the actual time taken for the function to fulfill or complete may vary, as it involves initiating a timer and returning a promise, which is not directly related to the input size but rather the specific task being performed.</p>
<p>Space complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>. The function uses a constant amount of space to store the promise and the timer. This does not change with the input value.</p>
<hr>
<h3 id="approach-2-asynchronous-programming-with-promises-and-settimeout-without-return">Approach 2: Asynchronous Programming with Promises and setTimeout without Return</h3>
<p>This approach is similar to the first one, but with a slight difference: for this problem, you don't need to explicitly return anything. This makes the following code a valid solution as well. This version of the <code>sleep</code> function doesn't return anything (or to be more precise, it returns <code>undefined</code>), because there's no return statement. But since the problem statement says, "It can resolve any value", this is perfectly acceptable. It's also a perfectly valid one-liner.</p>
<h4 id="implementation-1">Implementation</h4>
<iframe src="https://leetcode.com/playground/7EiDagMy/shared" width="100%" height="106" name="user-content-7EiDagMy" allowfullscreen="" translate="no"></iframe>
<h4 id="complexity-analysis-1">Complexity Analysis</h4>
<p>Time complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>. The time complexity of the function is <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span> because the computational effort remains constant regardless of the input. However, the actual time taken for the function to fulfill or complete may vary, as it involves initiating a timer and returning a promise, which is not directly related to the input size but rather the specific task being performed.</p>
<p>Space complexity: <span class="math math-inline"><span class="katex"><span class="katex-mathml">O(1)O(1)</span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>. The function uses a constant amount of space to store the promise and the timer. This does not change with the input value.</p>
<hr></div></div></div>
